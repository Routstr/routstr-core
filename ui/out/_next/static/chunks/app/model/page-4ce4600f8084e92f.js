(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{834:(e,s,t)=>{"use strict";t.d(s,{T:()=>l});var a=t(3422);t(4398);var r=t(9183);function l(e){let{className:s,...t}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}},2264:(e,s,t)=>{"use strict";t.d(s,{bq:()=>u,eb:()=>p,gC:()=>m,l6:()=>d,yv:()=>c});var a=t(3422);t(4398);var r=t(3439),l=t(9994),i=t(8940),n=t(4967),o=t(9183);function d(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"select",...s})}function c(e){let{...s}=e;return(0,a.jsx)(r.WT,{"data-slot":"select-value",...s})}function u(e){let{className:s,size:t="default",children:i,...n}=e;return(0,a.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":t,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n,children:[i,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function m(e){let{className:s,children:t,position:l="popper",...i}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(h,{}),(0,a.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(x,{})]})})}function p(e){let{className:s,children:t,...l}=e;return(0,a.jsxs)(r.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(i.A,{className:"size-4"})})}),(0,a.jsx)(r.p4,{children:t})]})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(n.A,{className:"size-4"})})}function x(e){let{className:s,...t}=e;return(0,a.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(l.A,{className:"size-4"})})}},6320:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>u,Es:()=>p,L3:()=>h,c7:()=>m,lG:()=>n,rr:()=>x,zM:()=>o});var a=t(3422);t(4398);var r=t(4316),l=t(9680),i=t(9183);function n(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"dialog",...s})}function o(e){let{...s}=e;return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...s})}function d(e){let{...s}=e;return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...s})}function c(e){let{className:s,...t}=e;return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function u(e){let{className:s,children:t,...n}=e;return(0,a.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,a.jsx)(c,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...n,children:[t,(0,a.jsxs)(r.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function p(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",s),...t})}function x(e){let{className:s,...t}=e;return(0,a.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",s),...t})}},6568:(e,s,t)=>{"use strict";t.d(s,{d:()=>i});var a=t(3422);t(4398);var r=t(2495),l=t(9183);function i(e){let{className:s,...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"switch",className:(0,l.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(r.zi,{"data-slot":"switch-thumb",className:(0,l.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},6715:(e,s,t)=>{Promise.resolve().then(t.bind(t,7557))},7557:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>e1});var a=t(3422),r=t(4398),l=t(100),i=t(2349),n=t(6013),o=t(9119),d=t(1407),c=t(552),u=t(9945);let m=u.Ik({id:u.Yj(),name:u.Yj(),full_name:u.Yj(),description:u.Yj().optional(),modelType:u.Yj(),isEnabled:u.zM(),createdAt:u.Yj().datetime(),updatedAt:u.Yj().datetime(),provider:u.Yj(),url:u.Yj().url(),api_key:u.Yj().optional(),input_cost:u.ai().min(0),output_cost:u.ai().min(0),min_cost_per_request:u.ai().min(0,"Minimum cost per request must be non-negative").default(0),min_cash_per_request:u.ai().min(0,"Minimum cash per request must be non-negative").default(0),contextLength:u.ai().int().optional(),apiKeyRequired:u.zM().default(!0),provider_id:u.Yj().optional(),is_free:u.zM().default(!1),soft_deleted:u.zM().optional(),has_own_api_key:u.zM(),api_key_type:u.Yj()});m.extend({settings:u.g1(u.L5()).optional(),pricing:u.Ik({inputCostPer1kTokens:u.ai().optional(),outputCostPer1kTokens:u.ai().optional(),unitCost:u.ai().optional()}).optional()}),m.omit({id:!0,createdAt:!0,updatedAt:!0,has_own_api_key:!0,api_key_type:!0}).extend({settings:u.g1(u.L5()).optional()}),m.partial().omit({id:!0,createdAt:!0,updatedAt:!0,has_own_api_key:!0,api_key_type:!0});let p=u.Ik({name:u.Yj().min(1,"Name is required"),full_name:u.Yj().optional(),input_cost:u.ai().min(0,"Input cost must be non-negative"),output_cost:u.ai().min(0,"Output cost must be non-negative"),provider:u.Yj().min(1,"Provider is required"),modelType:u.k5(["text","embedding","image","audio","multimodal"]),description:u.Yj().optional().transform(e=>""===e?void 0:e),contextLength:u.ai().int().min(0).optional().transform(e=>0===e?void 0:e)}).transform(e=>({...e})),h=u.Ik({provider:u.Yj().min(1,"Provider is required"),group_api_key:u.Yj().transform(e=>""===e?void 0:e).optional(),group_url:u.Yj().transform(e=>""===e?void 0:e).pipe(u.Yj().url("Please enter a valid URL").optional()).optional()});u.Ik({data:u.YO(m),pagination:u.Ik({total:u.ai(),page:u.ai(),pageSize:u.ai(),totalPages:u.ai()})}),u.Ik({modelId:u.Yj(),input:u.Yj(),parameters:u.g1(u.L5()).optional()}),u.Ik({output:u.Yj(),usage:u.Ik({promptTokens:u.ai().optional(),completionTokens:u.ai().optional(),totalTokens:u.ai().optional()}).optional(),timings:u.Ik({totalMs:u.ai()}).optional()});var x=t(3648),g=t(268),j=t(834),v=t(6320),f=t(2264),y=t(6950),b=t(9183),N=t(3130);let w=d.Op,_=r.createContext({}),k=e=>{let{...s}=e;return(0,a.jsx)(_.Provider,{value:{name:s.name},children:(0,a.jsx)(d.xI,{...s})})},C=()=>{let e=r.useContext(_),s=r.useContext(M),{getFieldState:t}=(0,d.xW)(),a=(0,d.lN)({name:e.name}),l=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...l}},M=r.createContext({});function A(e){let{className:s,...t}=e,l=r.useId();return(0,a.jsx)(M.Provider,{value:{id:l},children:(0,a.jsx)("div",{"data-slot":"form-item",className:(0,b.cn)("grid gap-2",s),...t})})}function S(e){let{className:s,...t}=e,{error:r,formItemId:l}=C();return(0,a.jsx)(N.J,{"data-slot":"form-label","data-error":!!r,className:(0,b.cn)("data-[error=true]:text-destructive",s),htmlFor:l,...t})}function F(e){let{...s}=e,{error:t,formItemId:r,formDescriptionId:l,formMessageId:i}=C();return(0,a.jsx)(y.DX,{"data-slot":"form-control",id:r,"aria-describedby":t?"".concat(l," ").concat(i):"".concat(l),"aria-invalid":!!t,...s})}function P(e){let{className:s,...t}=e,{formDescriptionId:r}=C();return(0,a.jsx)("p",{"data-slot":"form-description",id:r,className:(0,b.cn)("text-muted-foreground text-sm",s),...t})}function R(e){var s;let{className:t,...r}=e,{error:l,formMessageId:i}=C(),n=l?String(null!=(s=null==l?void 0:l.message)?s:""):r.children;return n?(0,a.jsx)("p",{"data-slot":"form-message",id:i,className:(0,b.cn)("text-destructive text-sm",t),...r,children:n}):null}var T=t(856),z=t(2434),E=t(3831);function I(e){let{onModelAdd:s,onCancel:t,isOpen:l}=e,[i,n]=(0,r.useState)(!1),o=(0,d.mN)({resolver:(0,c.u)(p),defaultValues:{name:"",full_name:"",input_cost:0,output_cost:0,provider:"",modelType:"text",description:"",contextLength:void 0}}),u=async e=>{n(!0);try{await s(e),E.oR.success("Model added successfully!"),o.reset(),null==t||t()}catch(e){E.oR.error("Failed to add model. Please try again."),console.error("Error adding model:",e)}finally{n(!1)}},m=()=>{i||(o.reset(),null==t||t())};return(0,a.jsx)(v.lG,{open:l,onOpenChange:m,children:(0,a.jsxs)(v.Cf,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[600px]",children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsxs)(v.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{className:"h-5 w-5"}),"Add New Model"]}),(0,a.jsx)(v.rr,{children:"Manually add a new AI model to your collection"})]}),(0,a.jsx)(w,{...o,children:(0,a.jsxs)("form",{onSubmit:o.handleSubmit(u),className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,a.jsx)(k,{control:o.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Model Name *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{placeholder:"e.g., GPT-4o",...s,className:"w-full"})}),(0,a.jsx)(P,{children:"Display name for the model"}),(0,a.jsx)(R,{})]})}}),(0,a.jsx)(k,{control:o.control,name:"provider",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Provider *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{placeholder:"e.g., OpenAI, Anthropic",...s,className:"w-full"})}),(0,a.jsx)(P,{children:"AI model provider or company"}),(0,a.jsx)(R,{})]})}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,a.jsx)(k,{control:o.control,name:"input_cost",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Input Cost (per 1M tokens) *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:"number",step:"0.001",min:"0",placeholder:"5.00",...s,value:s.value?parseFloat(s.value.toFixed(3)):"",onChange:e=>{let t=Math.round(1e3*(parseFloat(e.target.value)||0))/1e3;s.onChange(t)},className:"w-full"})}),(0,a.jsx)(P,{children:"Cost in USD per 1,000,000 input tokens (max 3 decimals)"}),(0,a.jsx)(R,{})]})}}),(0,a.jsx)(k,{control:o.control,name:"output_cost",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Output Cost (per 1M tokens) *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:"number",step:"0.001",min:"0",placeholder:"15.00",...s,value:s.value?parseFloat(s.value.toFixed(3)):"",onChange:e=>{let t=Math.round(1e3*(parseFloat(e.target.value)||0))/1e3;s.onChange(t)},className:"w-full"})}),(0,a.jsx)(P,{children:"Cost in USD per 1,000,000 output tokens (max 3 decimals)"}),(0,a.jsx)(R,{})]})}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,a.jsx)(k,{control:o.control,name:"modelType",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Model Type"}),(0,a.jsxs)(f.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,a.jsx)(F,{children:(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Select model type"})})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"text",children:"Text/Chat"}),(0,a.jsx)(f.eb,{value:"embedding",children:"Embedding"}),(0,a.jsx)(f.eb,{value:"image",children:"Image Generation"}),(0,a.jsx)(f.eb,{value:"audio",children:"Audio"}),(0,a.jsx)(f.eb,{value:"multimodal",children:"Multimodal"})]})]}),(0,a.jsx)(P,{children:"Type of AI model functionality"}),(0,a.jsx)(R,{})]})}}),(0,a.jsx)(k,{control:o.control,name:"contextLength",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Context Length"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:"number",min:"0",placeholder:"8192",value:s.value||"",onChange:e=>{let t=parseInt(e.target.value);s.onChange(isNaN(t)||0===t?void 0:t)},className:"w-full"})}),(0,a.jsx)(P,{children:"Maximum context length in tokens (optional, leave empty for default)"}),(0,a.jsx)(R,{})]})}})]}),(0,a.jsx)(k,{control:o.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Description"}),(0,a.jsx)(F,{children:(0,a.jsx)(j.T,{placeholder:"Brief description of the model...",...s,rows:3,className:"w-full"})}),(0,a.jsx)(P,{children:"Optional description or notes about the model"}),(0,a.jsx)(R,{})]})}}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(x.$,{type:"button",variant:"outline",onClick:m,disabled:i,children:"Cancel"}),(0,a.jsx)(x.$,{type:"submit",disabled:i,children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding..."]}):"Add Model"})]})]})})]})})}var q=t(7996),L=t(6568);let Y=u.Ik({name:u.Yj().min(1,"Name is required"),description:u.Yj().optional(),context_length:u.au.number().min(0),prompt:u.au.number().min(0),completion:u.au.number().min(0),enabled:u.zM()}),O=e=>null==e||isNaN(e)?0:Math.round(1e5*e)/1e5;function U(e){let{model:s,providerId:t,onModelUpdate:l,onCancel:i,isOpen:n}=e,[u,m]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[f,y]=(0,r.useState)(!1),b=(0,d.mN)({resolver:(0,c.u)(Y),defaultValues:{name:s.name,description:s.description||"",context_length:s.contextLength||4096,prompt:O(s.input_cost),completion:O(s.output_cost),enabled:!1!==s.isEnabled}}),N=(0,r.useCallback)(async()=>{if(!t)return void console.error("loadAdminModel called without providerId");try{console.log("Loading admin model:",{providerId:t,modelId:s.full_name});let e=await o.zQ.getProviderModel(t,s.full_name);h(e),y(!1),b.reset({name:e.name,description:e.description||"",context_length:e.context_length,prompt:O(e.pricing.prompt),completion:O(e.pricing.completion),enabled:!1!==e.enabled})}catch(e){console.log("Model not in database, will create new override:",e),y(!0),h({id:s.full_name,name:s.name,description:s.description||"",created:Math.floor(Date.now()/1e3),context_length:s.contextLength||4096,architecture:{modality:s.modelType||"text",input_modalities:[s.modelType||"text"],output_modalities:[s.modelType||"text"],tokenizer:"",instruct_type:null},pricing:{prompt:O(s.input_cost),completion:O(s.output_cost),request:0,image:0,web_search:0,internal_reasoning:0},per_request_limits:null,top_provider:null,upstream_provider_id:t,enabled:!1!==s.isEnabled}),b.reset({name:s.name,description:s.description||"",context_length:s.contextLength||4096,prompt:O(s.input_cost),completion:O(s.output_cost),enabled:!1!==s.isEnabled})}},[t,s,b]);(0,r.useEffect)(()=>{n&&t?N():n&&!t&&(console.error("EditModelForm opened without providerId",{model:s,providerId:t}),E.oR.error("Missing provider information for this model"))},[n,t,s,N]);let _=async e=>{if(!t){console.error("onSubmit called without providerId",{model:s,providerId:t}),E.oR.error("Missing provider ID - cannot update model");return}if(!p){console.error("onSubmit called without adminModelData",{model:s,providerId:t,adminModelData:p}),E.oR.error("Model data not loaded - please try reopening the form");return}m(!0);try{let s={id:p.id,name:e.name,description:e.description||"",created:p.created||Math.floor(Date.now()/1e3),context_length:e.context_length,architecture:p.architecture||{modality:"text",input_modalities:["text"],output_modalities:["text"],tokenizer:"",instruct_type:null},pricing:{prompt:O(e.prompt),completion:O(e.completion),request:0,image:0,web_search:0,internal_reasoning:0},per_request_limits:p.per_request_limits,top_provider:p.top_provider,upstream_provider_id:t,enabled:e.enabled};f?(console.log("Creating new model override"),await o.zQ.createProviderModel(t,s),E.oR.success("Model override created successfully!")):(console.log("Updating existing model override"),await o.zQ.updateProviderModel(t,p.id,s),E.oR.success("Model updated successfully!")),null==l||l(),null==i||i()}catch(s){let e=f?"create":"update";E.oR.error("Failed to ".concat(e," model. Please try again.")),console.error("Error ".concat(e,"ing model:"),s)}finally{m(!1)}},C=()=>{u||null==i||i()};return(0,a.jsx)(v.lG,{open:n,onOpenChange:C,children:(0,a.jsxs)(v.Cf,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[600px]",children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsxs)(v.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(q.A,{className:"h-5 w-5"}),f?"Create Model Override":"Edit Model Override"]}),(0,a.jsx)(v.rr,{children:f?"Create an override for &quot;".concat(s.name,"&quot;"):"Update the model override for &quot;".concat(s.name,"&quot;")})]}),(0,a.jsx)(w,{...b,children:(0,a.jsxs)("form",{onSubmit:b.handleSubmit(_),className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,a.jsx)(k,{control:b.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Display Name *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{placeholder:"e.g., GPT-4",...s,className:"w-full"})}),(0,a.jsx)(P,{children:"Custom display name for the model"}),(0,a.jsx)(R,{})]})}}),(0,a.jsx)(k,{control:b.control,name:"context_length",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Context Length *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:"number",min:"0",placeholder:"4096",...s,className:"w-full"})}),(0,a.jsx)(P,{children:"Maximum context window size"}),(0,a.jsx)(R,{})]})}})]}),(0,a.jsx)(k,{control:b.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Description"}),(0,a.jsx)(F,{children:(0,a.jsx)(j.T,{placeholder:"Brief description of the model...",...s,rows:3,className:"w-full"})}),(0,a.jsx)(P,{children:"Optional description or notes about the model"}),(0,a.jsx)(R,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,a.jsx)(k,{control:b.control,name:"prompt",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Input Cost (per 1M tokens) *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:"number",step:"0.00001",min:"0",placeholder:"5.00000",value:null!=(s=t.value)?s:"",onChange:e=>{let s=e.target.value;t.onChange(""===s?0:parseFloat(s))},onBlur:e=>{let s=parseFloat(e.target.value);t.onChange(O(s))},className:"w-full"})}),(0,a.jsx)(P,{children:"Cost in USD per 1,000,000 input tokens (max 5 decimals)"}),(0,a.jsx)(R,{})]})}}),(0,a.jsx)(k,{control:b.control,name:"completion",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Output Cost (per 1M tokens) *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:"number",step:"0.00001",min:"0",placeholder:"15.00000",value:null!=(s=t.value)?s:"",onChange:e=>{let s=e.target.value;t.onChange(""===s?0:parseFloat(s))},onBlur:e=>{let s=parseFloat(e.target.value);t.onChange(O(s))},className:"w-full"})}),(0,a.jsx)(P,{children:"Cost in USD per 1,000,000 output tokens (max 5 decimals)"}),(0,a.jsx)(R,{})]})}})]}),(0,a.jsx)(k,{control:b.control,name:"enabled",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(S,{className:"text-base",children:"Model Enabled"}),(0,a.jsx)(P,{children:"Enable or disable this model override"})]}),(0,a.jsx)(F,{children:(0,a.jsx)(L.d,{checked:s.value,onCheckedChange:s.onChange})})]})}}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(x.$,{type:"button",variant:"outline",onClick:C,disabled:u,children:"Cancel"}),(0,a.jsx)(x.$,{type:"submit",disabled:u,children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),f?"Creating...":"Updating..."]}):f?"Create Override":"Update Model"})]})]})})]})})}var J=t(1935),Q=t(5195),K=t(9906),D=t(2267),G=t(1220),$=t(9442);function V(e){let{provider:s,models:t,groupSettings:l,onGroupUpdate:i,onCancel:n,isOpen:o}=e,[u,m]=(0,r.useState)(!1),[p,j]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!!(null==l?void 0:l.group_url)),b=(0,d.mN)({resolver:(0,c.u)(h),defaultValues:{provider:s,group_api_key:(null==l?void 0:l.group_api_key)||"",group_url:(null==l?void 0:l.group_url)||""}}),N=async e=>{m(!0);try{var t,a;let r={...e,group_api_key:(null==(t=e.group_api_key)?void 0:t.trim())||void 0,group_url:f&&(null==(a=e.group_url)?void 0:a.trim())||void 0};await i(s,r),E.oR.success('Group "'.concat(s,'" updated successfully!')),null==n||n()}catch(e){E.oR.error("Failed to update group. Please try again."),console.error("Error updating group:",e)}finally{m(!1)}},_=t.filter(e=>!e.api_key).length,C=t.filter(e=>!e.api_key&&(!e.url||e.url.startsWith("/"))).length,M=()=>{u||null==n||n()};return(0,a.jsx)(v.lG,{open:o,onOpenChange:M,children:(0,a.jsxs)(v.Cf,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[700px]",children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsxs)(v.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(J.A,{className:"h-5 w-5"}),"Edit Provider Group: ",s]}),(0,a.jsxs)(v.rr,{children:["Update settings for all ",t.length," models in this group. Group settings provide defaults for models without individual configurations."]})]}),(0,a.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,a.jsxs)("div",{className:"rounded-md border p-4",children:[(0,a.jsxs)("h4",{className:"mb-2 flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)(Q.A,{className:"h-4 w-4"}),"API Key Configuration"]}),(0,a.jsx)("div",{className:"space-y-2 text-sm",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Models using group API key:"}),(0,a.jsx)("span",{className:"font-medium text-blue-600",children:_})]})})]}),(0,a.jsxs)("div",{className:"rounded-md border p-4",children:[(0,a.jsxs)("h4",{className:"mb-2 flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),"URL Configuration"]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Models using group URL:"}),(0,a.jsx)("span",{className:"font-medium text-blue-600",children:C})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Models with individual URLs:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:t.length-C})]}),(null==l?void 0:l.group_url)&&(0,a.jsxs)("div",{className:"mt-2 rounded bg-blue-50 p-2 text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:"Current group URL:"})," ",l.group_url]})]})]}),(0,a.jsxs)("div",{className:"rounded-md border p-4",children:[(0,a.jsx)("h4",{className:"mb-2 text-sm font-medium",children:"Models in this group:"}),(0,a.jsx)("div",{className:"max-h-32 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ".concat(e.api_key?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),title:e.api_key?"Has individual API key and URL":"Uses group API key and URL",children:[e.name,e.api_key&&" \uD83D\uDD11",e.url&&!e.url.startsWith("/")&&e.api_key&&" \uD83C\uDF10"]},e.id))})})]})]}),(0,a.jsx)(w,{...b,children:(0,a.jsxs)("form",{onSubmit:b.handleSubmit(N),className:"space-y-6",children:[(0,a.jsx)(k,{control:b.control,name:"provider",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Provider Name *"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{placeholder:"e.g., OpenAI, Anthropic",...s,className:"w-full"})}),(0,a.jsx)(P,{children:"This will update the provider name for all models in this group"}),(0,a.jsx)(R,{})]})}}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(S,{className:"text-base",children:"Group Base URL"}),(0,a.jsx)(P,{children:"Provide a custom base URL for this provider group"})]}),(0,a.jsx)(L.d,{checked:f,onCheckedChange:y})]}),f&&(0,a.jsx)(k,{control:b.control,name:"group_url",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Base URL"}),(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{placeholder:"https://api.openai.com/v1 or https://your-proxy.com/v1",...s,className:"w-full"})}),(0,a.jsx)(P,{children:"This base URL will be used for models without individual URLs. Models will append their endpoint path (e.g., /chat/completions) to this base."}),(0,a.jsx)(R,{})]})}}),!f&&(null==l?void 0:l.group_url)&&(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(D.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"Removing the group URL will make models in this group fall back to the default system endpoint. Models with individual URLs will be unaffected."})]}),f&&!(null==l?void 0:l.group_url)&&(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"Adding a group URL will allow models in this group to use a custom endpoint instead of the default system endpoint."})]})]}),(0,a.jsx)(k,{control:b.control,name:"group_api_key",render:e=>{let{field:s}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(S,{children:"Group API Key"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(F,{children:(0,a.jsx)(g.p,{type:p?"text":"password",placeholder:"sk-... (leave empty to remove)",...s,className:"w-full pr-24"})}),(0,a.jsx)(x.$,{type:"button",variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>j(!p),children:p?"Hide":"Show"})]}),(0,a.jsxs)(P,{children:["This API key will be used for models that don't have individual API keys (",_," models). Leave empty to remove the group API key."]}),(0,a.jsx)(R,{})]})}}),(0,a.jsxs)("div",{className:"rounded-md border border-amber-200 bg-amber-50 p-4",children:[(0,a.jsx)("p",{className:"text-sm text-amber-800",children:(0,a.jsx)("strong",{children:"How group settings work:"})}),(0,a.jsxs)("ul",{className:"mt-2 list-inside list-disc space-y-1 text-sm text-amber-800",children:[(0,a.jsx)("li",{children:"Models with individual API keys and URLs will keep their specific settings"}),(0,a.jsx)("li",{children:"Models without individual settings will use the group defaults"}),(0,a.jsx)("li",{children:"Removing the group URL makes models fall back to the system default endpoint"}),(0,a.jsx)("li",{children:'You can use "Apply Group Settings" to force models to use group configurations'})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(x.$,{type:"button",variant:"outline",onClick:M,disabled:u,children:"Cancel"}),(0,a.jsx)(x.$,{type:"submit",disabled:u,children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):"Update Group"})]})]})})]})})}var B=t(7228),W=t(9675),Z=t(246),H=t(1853),X=t(8940);function ee(e){let{className:s,...t}=e;return(0,a.jsx)(H.bL,{"data-slot":"checkbox",className:(0,b.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(H.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(X.A,{className:"size-3.5"})})})}var es=t(9625);function et(e){let{className:s,children:t,...r}=e;return(0,a.jsxs)(es.bL,{"data-slot":"scroll-area",className:(0,b.cn)("relative",s),...r,children:[(0,a.jsx)(es.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,a.jsx)(ea,{}),(0,a.jsx)(es.OK,{})]})}function ea(e){let{className:s,orientation:t="vertical",...r}=e;return(0,a.jsx)(es.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,b.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",s),...r,children:(0,a.jsx)(es.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var er=t(8561);function el(e){let{isOpen:s,onClose:t,onSuccess:l}=e,[i,n]=(0,r.useState)(null),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)([]),[p,h]=(0,r.useState)(new Set),[g,j]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[_,k]=(0,r.useState)(null),C=(0,r.useCallback)(async()=>{if(i){b(!0),m([]),h(new Set);try{let e=await o.zQ.getProviderModels(i),s=new Set(e.db_models.map(e=>e.id)),t=e.remote_models.filter(e=>!s.has(e.id));m(t)}catch(e){E.oR.error("Failed to fetch models from provider")}finally{b(!1)}}},[i]);(0,r.useEffect)(()=>{s&&M()},[s]),(0,r.useEffect)(()=>{i&&C()},[i,C]);let M=async()=>{j(!0);try{let e=await o.zQ.getUpstreamProviders();c(e)}catch(e){E.oR.error("Failed to load providers")}finally{j(!1)}},A=e=>{let s=new Set(p);s.has(e)?s.delete(e):s.add(e),h(s)},S=async()=>{if(0===p.size)return void E.oR.error("Please select at least one model");w(!0);let e=0,s=0,t=[];try{for(let a of Array.from(p)){let r=u.find(e=>e.id===a);if(r)try{await o.zQ.createModel({...r,upstream_provider_id:i,enabled:!0,created:Math.floor(Date.now()/1e3)}),e++}catch(r){let e=r instanceof Error?r.message:"Unknown error";e.includes("already exists")?s++:t.push("".concat(a,": ").concat(e))}}k({added:e,skipped:s,errors:t}),e>0&&(E.oR.success("Successfully added ".concat(e," models")),null==l||l()),t.length>0&&E.oR.warning("Completed with ".concat(t.length," errors"))}catch(e){E.oR.error("Failed to collect models")}finally{w(!1)}},F=()=>{N||(n(null),m([]),h(new Set),k(null),t())};return(0,a.jsx)(v.lG,{open:s,onOpenChange:F,children:(0,a.jsxs)(v.Cf,{className:"max-h-[80vh] sm:max-w-[700px]",children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsxs)(v.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(B.A,{className:"h-5 w-5"}),"Collect Models from Provider"]}),(0,a.jsx)(v.rr,{children:"Fetch models from an upstream provider and add them to your database"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Select Provider"}),(0,a.jsxs)(f.l6,{value:null==i?void 0:i.toString(),onValueChange:e=>n(parseInt(e)),disabled:g,children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Choose an upstream provider"})}),(0,a.jsx)(f.gC,{children:d.map(e=>(0,a.jsxs)(f.eb,{value:e.id.toString(),children:[e.provider_type," - ",e.base_url]},e.id))})]})]}),y&&(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(z.A,{className:"h-8 w-8 animate-spin"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading models from provider..."})]}),!y&&i&&u.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:[u.length," models available"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>{h(new Set(u.map(e=>e.id)))},disabled:N,children:"Select All"}),(0,a.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>{h(new Set)},disabled:N,children:"Deselect All"})]})]}),(0,a.jsx)(et,{className:"h-[300px] rounded-md border p-4",children:(0,a.jsx)("div",{className:"space-y-2",children:u.map(e=>(0,a.jsxs)("div",{className:"hover:bg-accent flex items-start space-x-3 rounded-lg border p-3",children:[(0,a.jsx)(ee,{checked:p.has(e.id),onCheckedChange:()=>A(e.id),disabled:N}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("div",{className:"font-mono text-sm font-medium",children:e.id}),(0,a.jsx)("div",{className:"text-muted-foreground text-xs",children:e.description||e.name}),e.context_length&&(0,a.jsxs)(er.E,{variant:"secondary",className:"text-xs",children:[e.context_length.toLocaleString()," tokens"]})]})]},e.id))})})]}),!y&&i&&0===u.length&&(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"No new models available from this provider. All models may already be in your database."})]}),_&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(Z.A,{className:"h-4 w-4"}),(0,a.jsxs)($.TN,{children:[(0,a.jsx)("strong",{children:"Collection Results:"}),(0,a.jsx)("br",{}),"• ",_.added," models added",(0,a.jsx)("br",{}),"• ",_.skipped," models skipped",_.errors.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("br",{}),"• ",_.errors.length," errors occurred"]})]})]}),_.errors.length>0&&(0,a.jsxs)($.Fc,{variant:"destructive",children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),(0,a.jsxs)($.TN,{children:[(0,a.jsx)("strong",{children:"Errors:"}),(0,a.jsxs)("ul",{className:"mt-1 list-inside list-disc text-sm",children:[_.errors.slice(0,3).map((e,s)=>(0,a.jsx)("li",{children:e},s)),_.errors.length>3&&(0,a.jsxs)("li",{children:["... and ",_.errors.length-3," more errors"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(x.$,{variant:"outline",onClick:F,disabled:N,children:_?"Close":"Cancel"}),(0,a.jsx)(x.$,{onClick:S,disabled:N||!i||0===p.size||y,children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding Models..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.A,{className:"mr-2 h-4 w-4"}),"Add ",p.size," Models"]})})]})]})]})})}function ei(e){return 0===e?"Free":e<1e-6?"$".concat(e.toFixed(8)):e<.001?"$".concat(e.toFixed(6)):e<.01?"$".concat(e.toFixed(4)):"$".concat(e.toFixed(3))}var en=t(2738),eo=t(2745),ed=t(8815);function ec(e){let{...s}=e;return(0,a.jsx)(ed.bL,{"data-slot":"alert-dialog",...s})}function eu(e){let{...s}=e;return(0,a.jsx)(ed.ZL,{"data-slot":"alert-dialog-portal",...s})}function em(e){let{className:s,...t}=e;return(0,a.jsx)(ed.hJ,{"data-slot":"alert-dialog-overlay",className:(0,b.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function ep(e){let{className:s,...t}=e;return(0,a.jsxs)(eu,{children:[(0,a.jsx)(em,{}),(0,a.jsx)(ed.UC,{"data-slot":"alert-dialog-content",className:(0,b.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function eh(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,b.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function ex(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,b.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function eg(e){let{className:s,...t}=e;return(0,a.jsx)(ed.hE,{"data-slot":"alert-dialog-title",className:(0,b.cn)("text-lg font-semibold",s),...t})}function ej(e){let{className:s,...t}=e;return(0,a.jsx)(ed.VY,{"data-slot":"alert-dialog-description",className:(0,b.cn)("text-muted-foreground text-sm",s),...t})}function ev(e){let{className:s,...t}=e;return(0,a.jsx)(ed.rc,{className:(0,b.cn)((0,x.r)(),s),...t})}function ef(e){let{className:s,...t}=e;return(0,a.jsx)(ed.ZD,{className:(0,b.cn)((0,x.r)({variant:"outline"}),s),...t})}var ey=t(6049);function eb(e){let{...s}=e;return(0,a.jsx)(ey.bL,{"data-slot":"dropdown-menu",...s})}function eN(e){let{...s}=e;return(0,a.jsx)(ey.l9,{"data-slot":"dropdown-menu-trigger",...s})}function ew(e){let{className:s,sideOffset:t=4,...r}=e;return(0,a.jsx)(ey.ZL,{children:(0,a.jsx)(ey.UC,{"data-slot":"dropdown-menu-content",sideOffset:t,className:(0,b.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...r})})}function e_(e){let{className:s,inset:t,variant:r="default",...l}=e;return(0,a.jsx)(ey.q7,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:(0,b.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...l})}function ek(e){let{className:s,...t}=e;return(0,a.jsx)(ey.wv,{"data-slot":"dropdown-menu-separator",className:(0,b.cn)("bg-border -mx-1 my-1 h-px",s),...t})}var eC=t(2034),eM=t(9987),eA=t(3545),eS=t(4963),eF=t(6541),eP=t(9197),eR=t(3732),eT=t(3728);function ez(e){let{filterProvider:s,groupData:t,showProviderActions:d=!1}=e,[c,u]=(0,r.useState)(""),[,m]=(0,r.useState)(null),[p,h]=(0,r.useState)(!1),[g,j]=(0,r.useState)(null),[v,f]=(0,r.useState)(null),[y,N]=(0,r.useState)(!1),[w,_]=(0,r.useState)(new Set),[k,C]=(0,r.useState)(!1),[M,A]=(0,r.useState)(!1),[S,F]=(0,r.useState)(!1),P=(0,l.jE)(),{data:R,isLoading:T,error:z,refetch:L}=(0,i.I)({queryKey:["models-with-providers"],queryFn:()=>o.zQ.getModelsWithProviders(),refetchOnWindowFocus:!1}),{models:Y=[],groups:O=[]}=R||{},G=(0,r.useMemo)(()=>s?Y.filter(e=>e.provider===s):Y,[Y,s]),$=(0,n.n)({mutationFn:async e=>{let s=Y.filter(s=>e.includes(s.id)).reduce((e,s)=>{let t=s.provider_id||"unknown";return e[t]||(e[t]=[]),e[t].push(s),e},{}),t=0;for(let[e,a]of Object.entries(s)){if("unknown"===e)continue;let s=a.map(e=>e.full_name);t+=(await o.zQ.deleteModels(s,e)).deleted_count}return{deleted_count:t,message:"Models deleted"}},onSuccess:e=>{E.oR.success("Successfully deleted ".concat(e.deleted_count," model overrides")),_(new Set),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to delete model overrides: ".concat(e.message))}}),B=(0,n.n)({mutationFn:async e=>{let s=Y.filter(s=>e.includes(s.id)).reduce((e,s)=>{let t=s.provider_id||"unknown";return e[t]||(e[t]=[]),e[t].push(s),e},{}),t=0;for(let[e,r]of Object.entries(s))if("unknown"!==e)for(let s of r){let r=parseInt(e);try{let e=await o.zQ.getProviderModel(r,s.full_name);await o.zQ.updateProviderModel(r,s.full_name,{...e,enabled:!1}),t++}catch(e){var a;if((null==(a=e.message)?void 0:a.includes("404"))||404===e.status){let e={id:s.full_name,name:s.name,description:s.description||"",created:Math.floor(Date.now()/1e3),context_length:s.contextLength||4096,architecture:{modality:s.modelType||"text",input_modalities:[s.modelType||"text"],output_modalities:[s.modelType||"text"],tokenizer:"",instruct_type:null},pricing:{prompt:s.input_cost,completion:s.output_cost,request:0,image:0,web_search:0,internal_reasoning:0},per_request_limits:null,top_provider:null,upstream_provider_id:r,enabled:!1};await o.zQ.createProviderModel(r,e),t++}}}return{deleted_count:t,message:"Models disabled"}},onSuccess:e=>{E.oR.success("Successfully disabled ".concat(e.deleted_count," models")),_(new Set),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to disable models: ".concat(e.message))}}),W=(0,n.n)({mutationFn:async e=>{if(!t)throw Error("No group data available");let s={};return s.api_key="",t.group_url&&(s.url=t.group_url),o.zQ.bulkUpdateModels(e,s)},onSuccess:e=>{E.oR.success("Successfully applied group settings to ".concat(e.updated_count," models")),e.errors.length>0&&(E.oR.warning("".concat(e.errors.length," models had errors during update")),console.warn("Bulk update errors:",e.errors)),_(new Set),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to apply group settings: ".concat(e.message))}}),H=(0,n.n)({mutationFn:()=>o.zQ.deleteAllModels(),onSuccess:e=>{E.oR.success("Successfully permanently deleted ".concat(e.deleted_count," models")),_(new Set),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to permanently delete all models: ".concat(e.message))}}),es=(0,n.n)({mutationFn:e=>o.zQ.deleteModelsByProvider(e),onSuccess:e=>{E.oR.success("Successfully permanently deleted ".concat(e.deleted_count," models from provider")),_(new Set),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to permanently delete provider models: ".concat(e.message))}}),et=(0,n.n)({mutationFn:async e=>{let s=Y.find(s=>s.id===e);if(!s)throw Error("Model not found");if(!s.provider_id)throw Error("Provider ID not available for this model");let t=parseInt(s.provider_id),a=await o.zQ.getProviderModel(t,s.full_name);return await o.zQ.updateProviderModel(t,s.full_name,{...a,enabled:!0}),{restored_count:1}},onSuccess:()=>{E.oR.success("Model enabled successfully"),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to enable model: ".concat(e.message))}}),ea=(0,n.n)({mutationFn:async e=>{let s=Y.filter(s=>e.includes(s.id)).reduce((e,s)=>{let t=s.provider_id||"unknown";return e[t]||(e[t]=[]),e[t].push(s),e},{}),t=0;for(let[e,a]of Object.entries(s))if("unknown"!==e)for(let s of a){let a=parseInt(e);try{let e=await o.zQ.getProviderModel(a,s.full_name);await o.zQ.updateProviderModel(a,s.full_name,{...e,enabled:!0}),t++}catch(e){console.error("Failed to enable model ".concat(s.full_name,":"),e)}}return{restored_count:t,message:"Models enabled"}},onSuccess:e=>{E.oR.success("Successfully enabled ".concat(e.restored_count," models")),_(new Set),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})},onError:e=>{E.oR.error("Failed to enable models: ".concat(e.message))}}),er=(0,r.useMemo)(()=>s?{[s]:G}:Y?Y.reduce((e,s)=>{let t=s.provider;return e[t]||(e[t]=[]),e[t].push(s),e},{}):{},[Y,G,s]),ed=(0,r.useMemo)(()=>new Map(O.map(e=>[e.provider,e])),[O]),eu=(0,r.useMemo)(()=>{let e={};return O.forEach(s=>{e[s.provider]={group_api_key:s.group_api_key,group_url:s.group_url}}),e},[O]),em=e=>{var s;return e.api_key?e.api_key:null==(s=eu[e.provider])?void 0:s.group_api_key},ey=e=>{let s=ed.get(e.provider),t=!!(e.api_key&&"string"==typeof e.api_key&&e.api_key!==(null==s?void 0:s.group_api_key)),a=!!(e.url&&"string"==typeof e.url&&!e.url.startsWith("/")&&e.url!==(null==s?void 0:s.group_url));return t||a},ez=async e=>{try{let s=O.find(s=>s.provider===e.provider);s||(s=await o.zQ.createModelGroup({provider:e.provider,group_api_key:void 0}));let t={name:e.name,full_name:e.name,input_cost:e.input_cost,output_cost:e.output_cost,provider:e.provider,modelType:e.modelType,description:e.description||void 0,contextLength:e.contextLength};await o.zQ.createModel(t),await L(),E.oR.success('Model "'.concat(e.name,'" added successfully!'))}catch(e){throw console.error("Error adding model:",e),E.oR.error("Failed to add model. Please try again."),e}},eE=async()=>{await L(),j(null)},eI=async(e,s)=>{try{let t=ed.get(e);t&&(await o.zQ.updateModelGroup(t.id,{provider:s.provider,group_api_key:s.group_api_key||void 0,group_url:s.group_url||void 0}),await L(),f(null),E.oR.success("Group updated successfully!"))}catch(e){console.error("Error updating group:",e),E.oR.error("Failed to update group. Please try again.")}},eq=async()=>{await L(),N(!1)},eL=async e=>{let s=ed.get(e);if(!(null==s?void 0:s.id))return void E.oR.error("No group configuration found for this provider");try{let e=await o.zQ.refreshModels({provider_id:s.id});E.oR.info(e.message),await L(),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})}catch(t){console.error("Error refreshing provider models:",t);let s=t instanceof Error?t.message:"Unknown error";E.oR.error("Failed to refresh ".concat(e," models: ").concat(s))}},eY=e=>{switch(e.toLowerCase()){case"text":default:return(0,a.jsx)(eC.A,{className:"h-4 w-4"});case"embedding":return(0,a.jsx)(eM.A,{className:"h-4 w-4"});case"image":return(0,a.jsx)(K.A,{className:"h-4 w-4"})}},eO=e=>{switch(e.toLowerCase()){case"text":return"bg-blue-100 text-blue-800";case"embedding":return"bg-purple-100 text-purple-800";case"image":return"bg-green-100 text-green-800";case"audio":return"bg-orange-100 text-orange-800";case"multimodal":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}},eU=e=>{let s=new Set(w);s.has(e)?s.delete(e):s.add(e),_(s)},eJ=e=>{let s=G.filter(s=>s.provider===e).map(e=>e.id),t=new Set(w);s.forEach(e=>t.add(e)),_(t)},eQ=e=>{let s=ed.get(e);(null==s?void 0:s.id)&&es.mutate(s.id)},eK=async e=>{let s=Y.find(s=>s.id===e);if(!s)return void E.oR.error("Model not found");if(!s.provider_id)return void E.oR.error("Provider ID not available for this model");try{let e=parseInt(s.provider_id);await o.zQ.deleteProviderModel(e,s.full_name),E.oR.success("Model override deleted successfully"),P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})}catch(s){let e=s instanceof Error?s.message:"Unknown error";E.oR.error("Failed to delete model override: ".concat(e))}},eD=async e=>{let s=Y.find(s=>s.id===e);if(!s)return void E.oR.error("Model not found");if(!s.provider_id)return void E.oR.error("Provider ID not available for this model");try{let e=parseInt(s.provider_id);try{let t=await o.zQ.getProviderModel(e,s.full_name);await o.zQ.updateProviderModel(e,s.full_name,{...t,enabled:!1}),E.oR.success("Model disabled successfully")}catch(a){var t;if((null==(t=a.message)?void 0:t.includes("404"))||404===a.status){let t={id:s.full_name,name:s.name,description:s.description||"",created:Math.floor(Date.now()/1e3),context_length:s.contextLength||4096,architecture:{modality:s.modelType||"text",input_modalities:[s.modelType||"text"],output_modalities:[s.modelType||"text"],tokenizer:"",instruct_type:null},pricing:{prompt:s.input_cost,completion:s.output_cost,request:0,image:0,web_search:0,internal_reasoning:0},per_request_limits:null,top_provider:null,upstream_provider_id:e,enabled:!1};await o.zQ.createProviderModel(e,t),E.oR.success("Model disabled successfully")}else throw a}P.invalidateQueries({queryKey:["models-with-providers"]}),P.invalidateQueries({queryKey:["all-provider-models"]}),P.invalidateQueries({queryKey:["upstream-providers"]})}catch(s){let e=s instanceof Error?s.message:"Unknown error";E.oR.error("Failed to disable model: ".concat(e))}};return T?(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsx)(eo.E,{className:"h-[200px]"}),(0,a.jsx)(eo.E,{className:"h-[200px]"})]}):z?(0,a.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:(0,a.jsx)("p",{className:"text-sm text-red-800",children:"Error loading models. Please try again later."})}):(0,a.jsxs)("div",{className:"grid gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-border h-6 w-px"}),(0,a.jsxs)(x.$,{onClick:()=>{let e=G.map(e=>e.id),s=new Set(w);e.forEach(e=>s.add(e)),_(s)},variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(eA.A,{className:"h-4 w-4"}),"Select All (",G.length,")"]}),w.size>0&&(0,a.jsxs)(x.$,{onClick:()=>{if(s){let e=G.map(e=>e.id),s=new Set(w);e.forEach(e=>s.delete(e)),_(s)}else _(new Set)},variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(eS.A,{className:"h-4 w-4"}),"Deselect All"]})]}),w.size>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-border h-6 w-px"}),(0,a.jsxs)("span",{className:"text-muted-foreground text-sm",children:[w.size," selected"]}),(()=>{let e=G.filter(e=>w.has(e.id)&&e.soft_deleted);return e.length>0&&(0,a.jsxs)(x.$,{onClick:()=>ea.mutate(e.map(e=>e.id)),variant:"outline",size:"sm",className:"gap-2 border-green-300 text-green-600 hover:border-green-400 hover:text-green-700",disabled:ea.isPending,children:[(0,a.jsx)(Z.A,{className:"h-4 w-4"}),"Enable Selected (",e.length,")"]})})(),(0,a.jsxs)(x.$,{onClick:()=>{C(!0)},variant:"destructive",size:"sm",className:"gap-2",disabled:$.isPending,children:[(0,a.jsx)(eF.A,{className:"h-4 w-4"}),"Delete Selected Overrides"]}),(0,a.jsxs)(x.$,{onClick:()=>{B.mutate(Array.from(w))},variant:"outline",size:"sm",className:"gap-2 border-orange-300 text-orange-600 hover:border-orange-400 hover:text-orange-700",disabled:B.isPending,children:[(0,a.jsx)(eP.A,{className:"h-4 w-4"}),"Disable Selected"]})]}),!d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-border h-6 w-px"}),(0,a.jsxs)(eb,{children:[(0,a.jsx)(eN,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(eR.A,{className:"h-4 w-4"}),"More Actions"]})}),(0,a.jsxs)(ew,{align:"end",children:[(0,a.jsxs)(e_,{onClick:()=>{_(new Set(G.map(e=>e.id)))},children:[(0,a.jsx)(eA.A,{className:"mr-2 h-4 w-4"}),"Select All Models"]}),(0,a.jsxs)(e_,{onClick:()=>{_(new Set)},children:[(0,a.jsx)(eS.A,{className:"mr-2 h-4 w-4"}),"Deselect All"]}),(0,a.jsx)(ek,{}),(0,a.jsxs)(e_,{onClick:()=>{A(!0)},className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4"}),"Delete All Models Permanently"]})]})]})]})]}),Object.entries(er).map(e=>{let[t,r]=e;if(s&&t!==s)return null;let l=ed.get(t),i=r.every(e=>w.has(e.id)),n=r.some(e=>w.has(e.id));return(0,a.jsxs)(en.Zp,{className:"overflow-hidden",children:[!s&&(0,a.jsx)(en.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(ee,{checked:i,ref:e=>{e&&"indeterminate"in e&&(e.indeterminate=n&&!i)},onCheckedChange:e=>{if(e)eJ(t);else{let e=r.map(e=>e.id),s=new Set(w);e.forEach(e=>s.delete(e)),_(s)}}}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(en.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,a.jsx)(J.A,{className:"h-5 w-5"}),t,(0,a.jsxs)("span",{className:"text-muted-foreground text-sm font-normal",children:["(",r.length," models)"]})]}),(0,a.jsxs)(en.BT,{children:[(null==l?void 0:l.group_url)?(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(K.A,{className:"h-3 w-3"}),l.group_url]}):"Using default endpoint",(null==l?void 0:l.group_api_key)&&(0,a.jsxs)("span",{className:"ml-2 flex items-center gap-1",children:[(0,a.jsx)(Q.A,{className:"h-3 w-3"}),"Group API Key"]})]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(eb,{children:[(0,a.jsx)(eN,{asChild:!0,children:(0,a.jsx)(x.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(eR.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(ew,{align:"end",children:[(0,a.jsxs)(e_,{onClick:()=>{l&&f({provider:t,models:r,groupData:l})},children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),"Edit Group"]}),(0,a.jsxs)(e_,{onClick:()=>eJ(t),children:[(0,a.jsx)(eA.A,{className:"mr-2 h-4 w-4"}),"Select All"]}),(0,a.jsxs)(e_,{onClick:()=>eL(t),children:[(0,a.jsx)(eT.A,{className:"mr-2 h-4 w-4"}),"Refresh Models"]}),(0,a.jsx)(ek,{}),(0,a.jsxs)(e_,{onClick:()=>eQ(t),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(eF.A,{className:"mr-2 h-4 w-4"}),"Delete All Models Permanently"]})]})]})})]})}),(0,a.jsx)(en.Wu,{className:s?"pt-6":"pt-0",children:(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:r.map(e=>(0,a.jsxs)(en.Zp,{className:(0,b.cn)("relative cursor-pointer overflow-hidden transition-all duration-200 hover:shadow-md",w.has(e.id)&&"ring-primary ring-2",c===e.id&&"ring-2 ring-blue-500",e.soft_deleted&&"border-red-200 bg-red-50 opacity-75"),onMouseEnter:()=>m(e.id),onMouseLeave:()=>m(null),children:[(0,a.jsx)(en.aR,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex items-start gap-2 pr-10",children:[(0,a.jsx)(ee,{checked:w.has(e.id),onCheckedChange:()=>eU(e.id),onClick:e=>e.stopPropagation(),className:"mt-1 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex w-[calc(100%-3rem)] items-start gap-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"mt-1 flex-shrink-0",children:eY(e.modelType)}),(0,a.jsxs)("div",{className:"w-full overflow-hidden",children:[(0,a.jsx)("h3",{className:(0,b.cn)("overflow-hidden text-sm font-medium text-ellipsis whitespace-nowrap",e.soft_deleted&&"text-red-600 line-through"),children:e.name}),e.full_name!==e.name&&(0,a.jsx)("p",{className:"text-muted-foreground overflow-hidden text-xs text-ellipsis whitespace-nowrap",children:e.full_name})]})]}),(0,a.jsx)("div",{className:"absolute top-3 right-2",children:(0,a.jsxs)(eb,{children:[(0,a.jsx)(eN,{asChild:!0,children:(0,a.jsx)(x.$,{variant:"ghost",size:"sm",onClick:e=>e.stopPropagation(),className:"h-8 w-8 p-0",children:(0,a.jsx)(eR.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(ew,{align:"end",children:[(0,a.jsxs)(e_,{onClick:s=>{s.stopPropagation(),u(e.id)},children:[(0,a.jsx)(X.A,{className:"mr-2 h-4 w-4"}),"Select for Test"]}),(0,a.jsxs)(e_,{onClick:s=>{s.stopPropagation(),j(e)},children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),"Edit Model"]}),(0,a.jsx)(ek,{}),e.soft_deleted?(0,a.jsxs)(e_,{onClick:s=>{s.stopPropagation(),et.mutate(e.id)},className:"text-green-600 focus:text-green-700",children:[(0,a.jsx)(Z.A,{className:"mr-2 h-4 w-4"}),"Enable Model"]}):(0,a.jsxs)(e_,{onClick:s=>{s.stopPropagation(),eD(e.id)},className:"text-orange-600 focus:text-orange-700",children:[(0,a.jsx)(eP.A,{className:"mr-2 h-4 w-4"}),"Disable Model"]}),(0,a.jsxs)(e_,{onClick:s=>{s.stopPropagation(),eK(e.id)},className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(eF.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]})}),(0,a.jsxs)(en.Wu,{className:"space-y-2 pt-0",onClick:()=>u(e.id),children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,a.jsx)("span",{className:(0,b.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",eO(e.modelType)),children:e.modelType}),"remote"===e.api_key_type&&(0,a.jsx)("span",{className:"inline-flex items-center rounded-full border border-blue-200 bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800",children:"Remote"}),"remote"!==e.api_key_type&&(0,a.jsx)("span",{className:"inline-flex items-center rounded-full border border-emerald-200 bg-emerald-100 px-2.5 py-0.5 text-xs font-medium text-emerald-800",children:"Database"}),e.is_free&&(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800",children:"Free"}),!em(e)&&(0,a.jsxs)("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800",children:[(0,a.jsx)(Q.A,{className:"mr-1 h-3 w-3"}),"No API Key"]}),em(e)&&!ey(e)&&(0,a.jsxs)("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800",children:[(0,a.jsx)(J.A,{className:"mr-1 h-3 w-3"}),"Group Key"]}),ey(e)&&(0,a.jsxs)("span",{className:"inline-flex items-center rounded-full bg-purple-100 px-2.5 py-0.5 text-xs font-medium text-purple-800",children:[(0,a.jsx)(Q.A,{className:"mr-1 h-3 w-3"}),"Individual Key"]}),e.soft_deleted&&(0,a.jsxs)("span",{className:"inline-flex items-center rounded-full border border-red-300 bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800",children:[(0,a.jsx)(eF.A,{className:"mr-1 h-3 w-3"}),"Deleted"]})]}),!e.is_free&&(0,a.jsxs)("div",{className:"text-muted-foreground space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"truncate",children:"Input:"}),(0,a.jsxs)("span",{className:"ml-2 truncate",children:[ei(e.input_cost),"/1M tokens"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"truncate",children:"Output:"}),(0,a.jsxs)("span",{className:"ml-2 truncate",children:[ei(e.output_cost),"/1M tokens"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"truncate",children:"Min cost:"}),(0,a.jsx)("span",{className:"ml-2 truncate",children:ei(e.min_cost_per_request)})]})]}),e.description&&(0,a.jsx)("p",{className:"text-muted-foreground line-clamp-2 overflow-hidden text-xs break-words text-ellipsis",children:e.description})]})]},e.id))})})]},t)}),(0,a.jsx)(I,{isOpen:p,onModelAdd:ez,onCancel:()=>h(!1)}),g&&(0,a.jsx)(U,{model:g,providerId:g.provider_id?parseInt(g.provider_id):void 0,onModelUpdate:eE,onCancel:()=>j(null),isOpen:!!g}),v&&(0,a.jsx)(V,{provider:v.provider,models:v.models,groupSettings:{group_api_key:v.groupData.group_api_key,group_url:v.groupData.group_url},onGroupUpdate:eI,onCancel:()=>f(null),isOpen:!!v}),(0,a.jsx)(el,{isOpen:y,onClose:()=>N(!1),onSuccess:eq}),(0,a.jsx)(ec,{open:k,onOpenChange:C,children:(0,a.jsxs)(ep,{children:[(0,a.jsxs)(eh,{children:[(0,a.jsx)(eg,{children:"Permanently Delete Selected Models"}),(0,a.jsxs)(ej,{children:["Are you sure you want to permanently delete ",w.size," ","selected models? This will completely remove them from the database and cannot be undone."]})]}),(0,a.jsxs)(ex,{children:[(0,a.jsx)(ef,{children:"Cancel"}),(0,a.jsx)(ev,{onClick:()=>{$.mutate(Array.from(w)),C(!1)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Models"})]})]})}),(0,a.jsx)(ec,{open:S,onOpenChange:F,children:(0,a.jsxs)(ep,{children:[(0,a.jsxs)(eh,{children:[(0,a.jsxs)(eg,{children:["Apply Group Settings to"," ",w.size===G.length&&s?"All Models in ".concat(s):"Selected Models"]}),(0,a.jsxs)(ej,{children:[w.size===G.length&&s?(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:["Are you sure you want to force ALL ",w.size," ","models in the ",(0,a.jsx)("strong",{children:s})," group to use group settings?"]}),(0,a.jsx)("p",{className:"mt-2 text-sm text-amber-600",children:(0,a.jsx)("strong",{children:"⚠️ This will override individual model configurations:"})})]}):(0,a.jsxs)("p",{children:["Are you sure you want to apply the group settings to"," ",w.size," selected models?"]}),(0,a.jsxs)("ul",{className:"mt-2 list-inside list-disc space-y-1 text-sm",children:[(0,a.jsx)("li",{children:"Remove individual API keys (models will use the group API key)"}),(null==t?void 0:t.group_url)&&(0,a.jsxs)("li",{children:["Set the URL to:"," ",(0,a.jsx)("code",{className:"rounded bg-gray-100 px-1",children:t.group_url})]}),(0,a.jsx)("li",{children:"Force models to use group configurations"}),w.size===G.length&&s&&(0,a.jsx)("li",{className:"font-medium text-amber-600",children:"This will affect ALL models in this provider group"})]})]})]}),(0,a.jsxs)(ex,{children:[(0,a.jsx)(ef,{children:"Cancel"}),(0,a.jsx)(ev,{onClick:()=>{W.mutate(Array.from(w)),F(!1)},className:"bg-blue-600 text-white hover:bg-blue-700",children:w.size===G.length&&s?"Force All ".concat(w.size," Models"):"Apply Group Settings"})]})]})}),(0,a.jsx)(ec,{open:M,onOpenChange:A,children:(0,a.jsxs)(ep,{children:[(0,a.jsxs)(eh,{children:[(0,a.jsx)(eg,{children:"Permanently Delete All Models"}),(0,a.jsxs)(ej,{children:["Are you sure you want to permanently delete ALL models? This will completely remove all ",Y.length," models from the database. This action cannot be undone."]})]}),(0,a.jsxs)(ex,{children:[(0,a.jsx)(ef,{children:"Cancel"}),(0,a.jsx)(ev,{onClick:()=>{H.mutate(),A(!1)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete All Models"})]})]})})]})}var eE=t(7916);u.Ik({id:u.Yj(),created_at:u.Yj(),updated_at:u.Yj(),provider:u.Yj(),group_api_key:u.Yj().optional(),group_url:u.Yj().optional()}),u.Ik({provider:u.Yj(),group_api_key:u.Yj().optional(),group_url:u.Yj().optional()}),u.Ik({provider:u.Yj().optional(),group_api_key:u.Yj().optional(),group_url:u.Yj().optional()}),u.Ik({base_endpoint:u.Yj(),api_key:u.Yj().optional(),provider_name:u.Yj(),default_input_cost:u.ai(),default_output_cost:u.ai(),default_min_cost:u.ai()}),u.Ik({collected_count:u.ai(),skipped_count:u.ai(),models:u.YO(u.bz()),errors:u.YO(u.Yj())}),u.Ik({provider_id:u.Yj()}),u.Ik({refreshed_count:u.ai(),created_count:u.ai(),restored_count:u.ai(),deleted_count:u.ai(),errors:u.YO(u.Yj())}),u.Ik({total_refreshed_count:u.ai(),total_created_count:u.ai(),total_restored_count:u.ai(),total_deleted_count:u.ai(),provider_results:u.YO(u.Ik({provider_name:u.Yj(),refreshed_count:u.ai(),created_count:u.ai(),restored_count:u.ai(),deleted_count:u.ai(),errors:u.YO(u.Yj())})),errors:u.YO(u.Yj())});let eI=u.Ik({id:u.Yj(),canonical_slug:u.Yj().optional(),hugging_face_id:u.Yj().optional(),name:u.Yj().optional(),created:u.ai(),description:u.Yj().optional(),context_length:u.ai().optional(),architecture:u.bz().optional(),pricing:u.bz().optional(),top_provider:u.bz().optional(),per_request_limits:u.bz().optional(),supported_parameters:u.YO(u.Yj()).optional(),provider_url:u.Yj(),provider_name:u.Yj().optional(),group_id:u.Yj().optional()});function eq(e,s){var t,a;return{id:e.id,name:e.name,full_name:e.full_name,description:e.description,modelType:e.model_type||"text",isEnabled:!e.soft_deleted,createdAt:e.created_at,updatedAt:e.updated_at,provider:e.provider||s||"",url:e.url,api_key:e.api_key,input_cost:Number(e.input_cost),output_cost:Number(e.output_cost),min_cost_per_request:Number(e.min_cost_per_request||"0"),min_cash_per_request:Number(e.min_cash_per_request||"0"),contextLength:e.context_length,apiKeyRequired:!0,provider_id:e.provider_id,is_free:null!=(t=e.is_free)&&t,soft_deleted:null!=(a=e.soft_deleted)&&a,has_own_api_key:e.has_own_api_key,api_key_type:e.api_key_type}}u.Ik({object:u.Yj(),data:u.YO(eI)}),u.Ik({id:u.Yj(),created_at:u.Yj(),updated_at:u.Yj(),full_name:u.Yj(),name:u.Yj(),url:u.Yj(),input_cost:u.Yj(),output_cost:u.Yj(),api_key:u.Yj().optional(),min_cash_per_request:u.Yj(),min_cost_per_request:u.Yj().optional(),provider_id:u.Yj().optional(),provider:u.Yj().optional(),soft_deleted:u.zM().optional(),architecture:u.bz().optional(),model_type:u.Yj().optional(),description:u.Yj().optional(),context_length:u.ai().optional(),is_free:u.zM().optional(),has_own_api_key:u.zM(),api_key_type:u.Yj()});class eL{static async createModelGroup(e){return await eE.apiClient.post("/api/model-groups",{provider:e.provider,group_api_key:e.group_api_key,group_url:e.group_url})}static async getModelGroups(){return await eE.apiClient.get("/api/model-groups")}static async getModelGroup(e){return await eE.apiClient.get("/api/model-groups/".concat(e))}static async updateModelGroup(e,s){return await eE.apiClient.put("/api/model-groups/".concat(e),{provider:s.provider,group_api_key:s.group_api_key,group_url:s.group_url})}static async deleteModelGroup(e){return await eE.apiClient.delete("/api/model-groups/".concat(e))}static async createModel(e){let s={full_name:e.name,name:e.name,url:e.url,api_key:e.api_key,input_cost:e.input_cost,output_cost:e.output_cost,min_cost_per_request:e.min_cost_per_request,min_cash_per_request:e.min_cash_per_request,provider:e.provider,model_type:e.modelType,description:e.description,context_length:e.contextLength,is_free:e.is_free};return eq(await eE.apiClient.post("/api/models",s))}static async getModels(){return(await eE.apiClient.get("/api/models")).map(e=>eq(e))}static async getModel(e){return eq(await eE.apiClient.get("/api/models/".concat(e)))}static async getModelsByProvider(e){return(await eE.apiClient.get("/api/models/provider/".concat(e))).map(e=>eq(e))}static async updateModel(e,s){let t={name:s.name,url:s.url,api_key:s.api_key,input_cost:s.input_cost,output_cost:s.output_cost,min_cost_per_request:s.min_cost_per_request,min_cash_per_request:s.min_cash_per_request,provider:s.provider,model_type:s.modelType,description:s.description,context_length:s.contextLength,is_free:s.is_free};return eq(await eE.apiClient.put("/api/models/".concat(e),t))}static async deleteModel(e){return await eE.apiClient.delete("/api/models/".concat(e))}static async softDeleteModel(e){return await eE.apiClient.put("/api/models/".concat(e,"/soft-delete"),{})}static async deleteModels(e){return await eE.apiClient.post("/api/models/bulk/delete",{model_ids:e})}static async softDeleteModels(e){return await eE.apiClient.post("/api/models/bulk/soft-delete",{model_ids:e})}static async bulkUpdateModels(e,s){return await eE.apiClient.post("/api/models/bulk/update",{model_ids:e,api_key:s.api_key,url:s.url})}static async deleteAllModels(){return await eE.apiClient.post("/api/models/all/delete",{})}static async deleteModelsByProvider(e){return await eE.apiClient.post("/api/models/provider/".concat(e,"/delete"),{})}static async restoreModels(e){return await eE.apiClient.post("/api/models/bulk/restore",{model_ids:e})}static async getSoftDeletedModels(){return(await eE.apiClient.get("/api/models/deleted")).map(e=>eq(e))}static async collectModels(e){return await eE.apiClient.post("/api/models/collect",e)}static async getModelsWithProviders(){let[e,s]=await Promise.all([eE.apiClient.get("/api/models"),this.getModelGroups()]),t=new Map(s.map(e=>[e.id,e.provider]));return{models:e.map(e=>eq(e,t.get(e.provider_id||"")||"Unknown")),groups:s}}static async listModels(e){let{models:s}=await this.getModelsWithProviders();return(null==e?void 0:e.enabled)!==!1?s.filter(e=>e.isEnabled):s}static async getModelInfo(e){return await this.getModel(e)}static async refreshModels(e){return await eE.apiClient.post("/api/models/refresh",e)}static async refreshAllModels(){return await eE.apiClient.post("/api/models/refresh-all",{})}static async getEnhancedModels(){return await eE.apiClient.get("/api/enhanced-models")}static async getEnhancedModelsByProvider(e){return await eE.apiClient.get("/api/enhanced-models/".concat(encodeURIComponent(e)))}static downloadModelsAsJson(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"models.json",t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=s,r.click(),URL.revokeObjectURL(a)}static async downloadAllEnhancedModels(){try{let e=await this.getEnhancedModels();this.downloadModelsAsJson(e,"enhanced-models-all.json")}catch(e){throw console.error("Error downloading all enhanced models:",e),e}}static async downloadEnhancedModelsByProvider(e){try{let s=await this.getEnhancedModelsByProvider(e);this.downloadModelsAsJson(s,"enhanced-models-".concat(e.toLowerCase(),".json"))}catch(s){throw console.error("Error downloading enhanced models for provider ".concat(e,":"),s),s}}static async testModel(e,s,t){return await eE.apiClient.post("/api/models/test",{model_id:e,endpoint_type:s,request_data:t})}}var eY=t(2390),eO=t(4717);function eU(e){var s,t;let{models:l}=e,[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)("You are a helpful assistant. Please respond concisely."),[m,p]=(0,r.useState)("Hello! Can you tell me what model you are and confirm that you are working correctly?"),[h,g]=(0,r.useState)(150),[v,y]=(0,r.useState)(.7),[b,w]=(0,r.useState)(null),[_,k]=(0,r.useState)(null),{data:C=[]}=(0,i.I)({queryKey:["model-groups"],queryFn:()=>eL.getModelGroups(),refetchOnWindowFocus:!1}),M=l.find(e=>e.id===o),A=(0,n.n)({mutationFn:async e=>{if(!M)throw Error("No model selected");k(null),w(null);try{console.log("Testing model via proxy: ".concat(M.name)),console.log("Request payload:",e);let s=await eL.testModel(M.id,"chat-completions",e);if(!s.success)throw Error(s.error||"Test failed");return s.data}catch(e){throw console.error("Model test error via proxy:",e),Error(e instanceof Error?e.message:"Failed to test model via proxy")}},onSuccess:e=>{w(e),E.oR.success("Model test completed successfully!")},onError:e=>{let s=(null==e?void 0:e.message)||"Unknown error occurred";k(s),E.oR.error("Model test failed: ".concat(s))}}),S=async()=>{if(!M)return void E.oR.error("Please select a model to test");if(!m.trim())return void E.oR.error("Please enter a test message");let e=[];c.trim()&&e.push({role:"system",content:c.trim()}),e.push({role:"user",content:m.trim()});let s={model:M.name,messages:e,max_tokens:h,temperature:v};A.mutate(s)},F=l.filter(e=>e.isEnabled),P=M?(e=>{let s=C.find(s=>s.provider===e.provider),t=e.api_key||(null==s?void 0:s.group_api_key),a=e.url;return e.url.startsWith("/")&&(null==s?void 0:s.group_url)&&(a="".concat(s.group_url.replace(/\/$/,"")).concat(e.url)),"text"!==e.modelType||a.includes("/chat/completions")||(a=a.replace(/\/$/,"")+"/chat/completions"),{apiKey:t,endpointUrl:a,group:s}})(M):null;return(0,a.jsxs)(en.Zp,{className:"w-full",children:[(0,a.jsxs)(en.aR,{children:[(0,a.jsxs)(en.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eY.A,{className:"h-5 w-5"}),"Model Credential Tester"]}),(0,a.jsx)(en.BT,{children:"Test model functionality by sending chat completion requests through the secure proxy (resolves CORS and network issues)"})]}),(0,a.jsxs)(en.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"model-select",children:"Select Model"}),(0,a.jsxs)(f.l6,{value:o,onValueChange:d,children:[(0,a.jsx)(f.bq,{id:"model-select",children:(0,a.jsx)(f.yv,{placeholder:"Choose a model to test..."})}),(0,a.jsx)(f.gC,{children:F.map(e=>(0,a.jsx)(f.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(er.E,{variant:"outline",className:"text-xs",children:e.provider}),e.is_free&&(0,a.jsx)(er.E,{variant:"secondary",className:"text-xs",children:"Free"})]})},e.id))})]}),M&&P&&(0,a.jsxs)("div",{className:"text-muted-foreground bg-muted space-y-2 rounded-md p-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Endpoint:"})," ",P.endpointUrl]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(Q.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"API Key:"})," ",P.apiKey?"".concat(P.apiKey.substring(0,8),"..."):"Not configured"]}),(0,a.jsx)(er.E,{variant:P.apiKey?"default":"destructive",className:"text-xs",children:M.api_key_type||"Unknown"})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Provider:"})," ",M.provider]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",M.modelType]})}),M.contextLength&&(0,a.jsx)("div",{children:(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Context Length:"})," ",M.contextLength.toLocaleString()]})}),!P.apiKey&&(0,a.jsxs)($.Fc,{variant:"default",className:"mt-2",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"No API key configured for this model. Testing may still work if the model is free or if authentication is handled elsewhere. For models requiring authentication, please add an API key to the model or its provider group."})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"max-tokens",children:"Max Tokens"}),(0,a.jsx)("input",{id:"max-tokens",type:"number",min:1,max:4e3,value:h,onChange:e=>g(parseInt(e.target.value)||150),className:"border-input bg-background w-full rounded-md border px-3 py-2 text-sm"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"temperature",children:"Temperature"}),(0,a.jsx)("input",{id:"temperature",type:"number",min:0,max:2,step:.1,value:v,onChange:e=>y(parseFloat(e.target.value)||.7),className:"border-input bg-background w-full rounded-md border px-3 py-2 text-sm"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"system-message",children:"System Message (Optional)"}),(0,a.jsx)(j.T,{id:"system-message",placeholder:"Enter system message...",value:c,onChange:e=>u(e.target.value),rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"user-message",children:"Test Message"}),(0,a.jsx)(j.T,{id:"user-message",placeholder:"Enter your test message...",value:m,onChange:e=>p(e.target.value),rows:3})]}),(0,a.jsx)(x.$,{onClick:S,disabled:!o||A.isPending,className:"w-full",children:A.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Testing Model..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eY.A,{className:"mr-2 h-4 w-4"}),"Test Model (via Proxy)"]})}),_&&(0,a.jsxs)($.Fc,{variant:"destructive",children:[(0,a.jsx)(eO.A,{className:"h-4 w-4"}),(0,a.jsxs)($.TN,{children:[(0,a.jsx)("strong",{children:"Test Failed:"})," ",_]})]}),b&&(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(Z.A,{className:"h-4 w-4"}),(0,a.jsxs)($.TN,{children:[(0,a.jsx)("strong",{children:"Test Successful!"})," Model responded correctly via secure proxy."]})]}),b&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Model Response"}),(0,a.jsx)("div",{className:"bg-muted rounded-md p-4",children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:(null==(t=b.choices[0])||null==(s=t.message)?void 0:s.content)||"No content in response"})})]}),b.usage&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Usage Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"font-semibold",children:b.usage.prompt_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Prompt Tokens"})]}),(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"font-semibold",children:b.usage.completion_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Completion Tokens"})]}),(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"font-semibold",children:b.usage.total_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Total Tokens"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Raw Response"}),(0,a.jsxs)("details",{className:"group",children:[(0,a.jsxs)("summary",{className:"text-muted-foreground hover:text-foreground cursor-pointer text-sm",children:[(0,a.jsx)(G.A,{className:"mr-1 inline h-4 w-4"}),"Show detailed response data"]}),(0,a.jsx)("pre",{className:"bg-muted mt-2 max-h-60 overflow-auto rounded-md p-4 text-xs",children:JSON.stringify(b,null,2)})]})]})]})]})]})}var eJ=t(4938),eQ=t(7137),eK=t(9472),eD=t(413),eG=t(9911),e$=t(4713),eV=t(9935),eB=t(8019);let eW={"chat-completions":{name:"Chat Completions",path:"/chat/completions",icon:eJ.A,description:"Test conversational AI with chat completion requests"},"vision-chat":{name:"Vision Chat (Image + Text)",path:"/chat/completions",icon:eQ.A,description:"Analyze images with text prompts using vision models"},embeddings:{name:"Embeddings",path:"/embeddings",icon:eK.A,description:"Generate embeddings for text input"},images:{name:"Image Generation",path:"/images/generations",icon:eD.A,description:"Generate images from text prompts"},"audio-speech":{name:"Text-to-Speech",path:"/audio/speech",icon:eG.A,description:"Convert text to speech audio"},"audio-transcription":{name:"Audio Transcription",path:"/audio/transcriptions",icon:e$.A,description:"Transcribe audio files to text"},models:{name:"List Models",path:"/model",icon:eK.A,description:"List all available models from the provider"}},eZ={"chat-completions":{systemMessage:"You are a helpful assistant. Please respond concisely.",userMessage:"Hello! Can you tell me what model you are and confirm that you are working correctly?",maxTokens:150,temperature:.7},"vision-chat":{systemMessage:"You are a helpful assistant that can analyze images. Please describe what you see.",userMessage:"What do you see in this image? Please provide a detailed description.",maxTokens:300,temperature:.7,imageDetail:"auto"},embeddings:{input:"The quick brown fox jumps over the lazy dog.",encoding_format:"float"},images:{prompt:"A beautiful sunset over a mountain landscape",n:1,size:"1024x1024",quality:"standard",style:"vivid"},"audio-speech":{input:"Hello, this is a test of the text-to-speech functionality.",voice:"alloy",response_format:"mp3",speed:1},"audio-transcription":{prompt:"This is a test transcription.",response_format:"json",temperature:0,language:""}};function eH(e){var s,t,l,o,d,c,u,m,p,h,v;let y,b,w,_,k,C,{models:M}=e,[A,S]=(0,r.useState)(""),[F,P]=(0,r.useState)("chat-completions"),[R,T]=(0,r.useState)(null),[I,q]=(0,r.useState)(null),[L,Y]=(0,r.useState)(eZ["chat-completions"].systemMessage),[O,U]=(0,r.useState)(eZ["chat-completions"].userMessage),[J,D]=(0,r.useState)(eZ["chat-completions"].maxTokens),[V,B]=(0,r.useState)(eZ["chat-completions"].temperature),[W,H]=(0,r.useState)(eZ["vision-chat"].systemMessage),[X,ee]=(0,r.useState)(eZ["vision-chat"].userMessage),[es,et]=(0,r.useState)(eZ["vision-chat"].maxTokens),[ea,el]=(0,r.useState)(eZ["vision-chat"].temperature),[ei,eo]=(0,r.useState)(eZ["vision-chat"].imageDetail),[ed,ec]=(0,r.useState)(null),[eu,em]=(0,r.useState)(null),[ep,eh]=(0,r.useState)(!1),[ex,eg]=(0,r.useState)(null),[ej,ev]=(0,r.useState)(null),[ef,ey]=(0,r.useState)(null),[eb,eN]=(0,r.useState)(eZ["audio-transcription"].prompt),[ew,e_]=(0,r.useState)(eZ["audio-transcription"].response_format),[ek,eC]=(0,r.useState)(eZ["audio-transcription"].temperature),[eM,eA]=(0,r.useState)(eZ["audio-transcription"].language),eS=(0,r.useRef)(null),eF=(0,r.useRef)(null),[eP,eR]=(0,r.useState)(eZ.embeddings.input),[eT,ez]=(0,r.useState)(eZ.embeddings.encoding_format),[eE,eI]=(0,r.useState)(eZ.images.prompt),[eq,eU]=(0,r.useState)(eZ.images.n),[eJ,eQ]=(0,r.useState)(eZ.images.size),[eH,eX]=(0,r.useState)(eZ.images.quality),[e0,e2]=(0,r.useState)(eZ.images.style),[e4,e1]=(0,r.useState)(eZ["audio-speech"].input),[e5,e3]=(0,r.useState)(eZ["audio-speech"].voice),[e6,e9]=(0,r.useState)(eZ["audio-speech"].response_format),[e8,e7]=(0,r.useState)(eZ["audio-speech"].speed),{data:se=[]}=(0,i.I)({queryKey:["model-groups"],queryFn:()=>eL.getModelGroups(),refetchOnWindowFocus:!1}),ss=M.find(e=>e.id===A),st=e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];t&&(t.type.startsWith("image/")?(ec(t),em(URL.createObjectURL(t))):E.oR.error("Please select a valid image file"))},sa=e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];t&&(t.type.startsWith("audio/")?(eg(t),ev(URL.createObjectURL(t))):E.oR.error("Please select a valid audio file"))},sr=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e),t=[];s.ondataavailable=e=>{e.data.size>0&&t.push(e.data)},s.onstop=()=>{let s=new Blob(t,{type:"audio/webm"}),a=new File([s],"recording.webm",{type:"audio/webm"});eg(a);let r=URL.createObjectURL(s);ev(r),e.getTracks().forEach(e=>e.stop())},s.start(),ey(s),eh(!0),E.oR.success("Recording started")}catch(e){console.error("Error starting recording:",e),E.oR.error("Failed to start recording. Please check microphone permissions.")}},sl=()=>{ef&&(ef.stop(),ey(null),eh(!1),E.oR.success("Recording stopped"))},si=e=>new Promise((s,t)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>s(a.result),a.onerror=e=>t(e)}),sn=async()=>{if(!ss)return null;switch(F){case"chat-completions":let e=[];return L.trim()&&e.push({role:"system",content:L.trim()}),e.push({role:"user",content:O.trim()}),{model:ss.name,messages:e,max_tokens:J,temperature:V};case"vision-chat":if(!ed)throw Error("Please select an image for vision analysis");let s=await si(ed),t=[];return W.trim()&&t.push({role:"system",content:W.trim()}),t.push({role:"user",content:[{type:"text",text:X.trim()},{type:"image_url",image_url:{url:s,detail:ei}}]}),{model:ss.name,messages:t,max_tokens:es,temperature:ea};case"embeddings":return{model:ss.name,input:eP,encoding_format:eT};case"images":return{model:ss.name,prompt:eE,n:eq,size:eJ,quality:eH,style:e0};case"audio-speech":return{model:ss.name,input:e4,voice:e5,response_format:e6,speed:e8};case"audio-transcription":if(!ex)throw Error("Please record or upload an audio file for transcription");return{model:ss.name,file:ex,prompt:eb.trim()||void 0,response_format:ew,temperature:ek,language:eM.trim()||void 0};default:return null}},so=(0,n.n)({mutationFn:async e=>{if(!ss)throw Error("No model selected");q(null),T(null);try{console.log("Testing endpoint via proxy: ".concat(F)),console.log("Request payload:",e);let s=await eL.testModel(ss.id,F,e);if(!s.success)throw Error(s.error||"Test failed");return s.data}catch(e){throw console.error("API endpoint test error via proxy:",e),Error(e instanceof Error?e.message:"Failed to test endpoint via proxy")}},onSuccess:e=>{T(e),E.oR.success("".concat(eW[F].name," test completed successfully!"))},onError:e=>{let s=(null==e?void 0:e.message)||"Unknown error occurred";q(s),E.oR.error("".concat(eW[F].name," test failed: ").concat(s))}}),sd=async()=>{if(!ss)return void E.oR.error("Please select a model to test");if("chat-completions"===F&&!O.trim())return void E.oR.error("Please enter a test message");if("vision-chat"===F){if(!X.trim())return void E.oR.error("Please enter a test message");if(!ed)return void E.oR.error("Please select an image for vision analysis")}if("embeddings"===F&&!eP.trim())return void E.oR.error("Please enter text for embedding");if("images"===F&&!eE.trim())return void E.oR.error("Please enter an image prompt");if("audio-speech"===F&&!e4.trim())return void E.oR.error("Please enter text for speech synthesis");if("audio-transcription"===F&&!ex)return void E.oR.error("Please record or upload an audio file for transcription");let e=await sn();so.mutate(e)},sc=M.filter(e=>e.isEnabled),su=ss?(e=>{let s=se.find(s=>s.provider===e.provider),t=e.api_key||(null==s?void 0:s.group_api_key),a=e.url;return e.url.startsWith("/")&&(null==s?void 0:s.group_url)&&(a="".concat(s.group_url.replace(/\/$/,"")).concat(e.url)),{apiKey:t,baseUrl:a=a.replace(/\/v1\/.*$/,"").replace(/\/$/,""),group:s}})(ss):null,sm=su?(k=su.baseUrl,C=eW[F].path,"".concat(k).concat(C)):"";return(0,a.jsxs)(en.Zp,{className:"w-full",children:[(0,a.jsxs)(en.aR,{children:[(0,a.jsxs)(en.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eY.A,{className:"h-5 w-5"}),"API Endpoint Tester"]}),(0,a.jsx)(en.BT,{children:"Comprehensive testing of OpenAI-compatible API endpoints through the secure proxy (resolves CORS and network issues)"})]}),(0,a.jsxs)(en.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"model-select",children:"Select Model"}),(0,a.jsxs)(f.l6,{value:A,onValueChange:S,children:[(0,a.jsx)(f.bq,{id:"model-select",children:(0,a.jsx)(f.yv,{placeholder:"Choose a model to test..."})}),(0,a.jsx)(f.gC,{children:sc.map(e=>(0,a.jsx)(f.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(er.E,{variant:"outline",className:"text-xs",children:e.provider}),e.is_free&&(0,a.jsx)(er.E,{variant:"secondary",className:"text-xs",children:"Free"})]})},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"endpoint-select",children:"API Endpoint"}),(0,a.jsxs)(f.l6,{value:F,onValueChange:e=>P(e),children:[(0,a.jsx)(f.bq,{id:"endpoint-select",children:(0,a.jsx)(f.yv,{})}),(0,a.jsx)(f.gC,{children:Object.entries(eW).map(e=>{let[s,t]=e,r=t.icon;return(0,a.jsx)(f.eb,{value:s,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:t.name})]})},s)})})]})]})]}),ss&&su&&(0,a.jsxs)("div",{className:"text-muted-foreground bg-muted space-y-2 rounded-md p-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Endpoint:"})," ",sm]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(Q.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"API Key:"})," ",su.apiKey?"".concat(su.apiKey.substring(0,8),"..."):"Not configured"]}),(0,a.jsx)(er.E,{variant:su.apiKey?"default":"destructive",className:"text-xs",children:ss.api_key_type||"Unknown"})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Provider:"})," ",ss.provider]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Description:"})," ",eW[F].description]})}),!su.apiKey&&(0,a.jsxs)($.Fc,{variant:"default",className:"mt-2",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"No API key configured for this model. Testing may still work if the model is free or if authentication is handled elsewhere. For models requiring authentication, please add an API key to the model or its provider group."})]})]}),(()=>{switch(F){case"chat-completions":return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"max-tokens",children:"Max Tokens"}),(0,a.jsx)(g.p,{id:"max-tokens",type:"number",min:1,max:4e3,value:J,onChange:e=>D(parseInt(e.target.value)||150)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"temperature",children:"Temperature"}),(0,a.jsx)(g.p,{id:"temperature",type:"number",min:0,max:2,step:.1,value:V,onChange:e=>B(parseFloat(e.target.value)||.7)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"system-message",children:"System Message (Optional)"}),(0,a.jsx)(j.T,{id:"system-message",placeholder:"Enter system message...",value:L,onChange:e=>Y(e.target.value),rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"user-message",children:"Test Message"}),(0,a.jsx)(j.T,{id:"user-message",placeholder:"Enter your test message...",value:O,onChange:e=>U(e.target.value),rows:3})]})]});case"vision-chat":return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"vision-max-tokens",children:"Max Tokens"}),(0,a.jsx)(g.p,{id:"vision-max-tokens",type:"number",min:1,max:4e3,value:es,onChange:e=>et(parseInt(e.target.value)||300)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"vision-temperature",children:"Temperature"}),(0,a.jsx)(g.p,{id:"vision-temperature",type:"number",min:0,max:2,step:.1,value:ea,onChange:e=>el(parseFloat(e.target.value)||.7)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"vision-system-message",children:"System Message (Optional)"}),(0,a.jsx)(j.T,{id:"vision-system-message",placeholder:"Enter system message...",value:W,onChange:e=>H(e.target.value),rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"vision-user-message",children:"Test Message"}),(0,a.jsx)(j.T,{id:"vision-user-message",placeholder:"Enter your test message...",value:X,onChange:e=>ee(e.target.value),rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-detail",children:"Image Detail"}),(0,a.jsxs)(f.l6,{value:ei,onValueChange:e=>eo(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"low",children:"Low"}),(0,a.jsx)(f.eb,{value:"high",children:"High"}),(0,a.jsx)(f.eb,{value:"auto",children:"Auto"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-upload",children:"Upload Image (Optional)"}),(0,a.jsx)(g.p,{type:"file",accept:"image/*",onChange:st,ref:eS,className:"file:mr-4 file:rounded-full file:border-0 file:bg-blue-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-blue-700 hover:file:bg-blue-100"}),ed&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,a.jsx)(eD.A,{className:"h-5 w-5 text-blue-500"}),(0,a.jsxs)("span",{className:"text-muted-foreground text-sm",children:["Selected image: ",ed.name]}),(0,a.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>ec(null),className:"ml-auto",children:"Remove"})]}),eu&&(0,a.jsx)("div",{className:"relative mt-2 aspect-square w-32 overflow-hidden rounded-md border",children:(0,a.jsx)(eB.default,{src:eu,alt:"Image preview",fill:!0,className:"object-cover"})})]})]});case"embeddings":return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"encoding-format",children:"Encoding Format"}),(0,a.jsxs)(f.l6,{value:eT,onValueChange:e=>ez(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"float",children:"Float"}),(0,a.jsx)(f.eb,{value:"base64",children:"Base64"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"embedding-input",children:"Text Input"}),(0,a.jsx)(j.T,{id:"embedding-input",placeholder:"Enter text to generate embeddings for...",value:eP,onChange:e=>eR(e.target.value),rows:4})]})]});case"images":return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-count",children:"Number of Images"}),(0,a.jsx)(g.p,{id:"image-count",type:"number",min:1,max:10,value:eq,onChange:e=>eU(parseInt(e.target.value)||1)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-size",children:"Size"}),(0,a.jsxs)(f.l6,{value:eJ,onValueChange:e=>eQ(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"256x256",children:"256x256"}),(0,a.jsx)(f.eb,{value:"512x512",children:"512x512"}),(0,a.jsx)(f.eb,{value:"1024x1024",children:"1024x1024"}),(0,a.jsx)(f.eb,{value:"1792x1024",children:"1792x1024"}),(0,a.jsx)(f.eb,{value:"1024x1792",children:"1024x1792"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-quality",children:"Quality"}),(0,a.jsxs)(f.l6,{value:eH,onValueChange:e=>eX(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"standard",children:"Standard"}),(0,a.jsx)(f.eb,{value:"hd",children:"HD"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-style",children:"Style"}),(0,a.jsxs)(f.l6,{value:e0,onValueChange:e=>e2(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"vivid",children:"Vivid"}),(0,a.jsx)(f.eb,{value:"natural",children:"Natural"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"image-prompt",children:"Image Prompt"}),(0,a.jsx)(j.T,{id:"image-prompt",placeholder:"Describe the image you want to generate...",value:eE,onChange:e=>eI(e.target.value),rows:3})]})]});case"audio-speech":return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"speech-voice",children:"Voice"}),(0,a.jsxs)(f.l6,{value:e5,onValueChange:e=>e3(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"alloy",children:"Alloy"}),(0,a.jsx)(f.eb,{value:"echo",children:"Echo"}),(0,a.jsx)(f.eb,{value:"fable",children:"Fable"}),(0,a.jsx)(f.eb,{value:"onyx",children:"Onyx"}),(0,a.jsx)(f.eb,{value:"nova",children:"Nova"}),(0,a.jsx)(f.eb,{value:"shimmer",children:"Shimmer"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"speech-format",children:"Response Format"}),(0,a.jsxs)(f.l6,{value:e6,onValueChange:e=>e9(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"mp3",children:"MP3"}),(0,a.jsx)(f.eb,{value:"opus",children:"Opus"}),(0,a.jsx)(f.eb,{value:"aac",children:"AAC"}),(0,a.jsx)(f.eb,{value:"flac",children:"FLAC"}),(0,a.jsx)(f.eb,{value:"wav",children:"WAV"}),(0,a.jsx)(f.eb,{value:"pcm",children:"PCM"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"speech-speed",children:"Speed"}),(0,a.jsx)(g.p,{id:"speech-speed",type:"number",min:.25,max:4,step:.25,value:e8,onChange:e=>e7(parseFloat(e.target.value)||1)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"speech-input",children:"Text to Synthesize"}),(0,a.jsx)(j.T,{id:"speech-input",placeholder:"Enter text to convert to speech...",value:e4,onChange:e=>e1(e.target.value),rows:4})]})]});case"audio-transcription":return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"audio-transcription-prompt",children:"Prompt (Optional)"}),(0,a.jsx)(j.T,{id:"audio-transcription-prompt",placeholder:"Enter a prompt for the transcription...",value:eb,onChange:e=>eN(e.target.value),rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"audio-transcription-temperature",children:"Temperature"}),(0,a.jsx)(g.p,{id:"audio-transcription-temperature",type:"number",min:0,max:1,step:.1,value:ek,onChange:e=>eC(parseFloat(e.target.value)||0)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"audio-transcription-language",children:"Language (Optional)"}),(0,a.jsx)(g.p,{id:"audio-transcription-language",placeholder:"e.g., en-US, fr-FR",value:eM,onChange:e=>eA(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"audio-transcription-response-format",children:"Response Format"}),(0,a.jsxs)(f.l6,{value:ew,onValueChange:e=>e_(e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"json",children:"JSON"}),(0,a.jsx)(f.eb,{value:"text",children:"Text"}),(0,a.jsx)(f.eb,{value:"srt",children:"SRT"}),(0,a.jsx)(f.eb,{value:"verbose_json",children:"Verbose JSON"}),(0,a.jsx)(f.eb,{value:"vtt",children:"VTT"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Voice Recording"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.$,{type:"button",variant:ep?"destructive":"default",size:"sm",onClick:ep?sl:sr,className:"flex items-center gap-2",children:ep?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eV.A,{className:"h-4 w-4"}),"Stop Recording"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eG.A,{className:"h-4 w-4"}),"Start Recording"]})}),ep&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)("div",{className:"h-2 w-2 animate-pulse rounded-full bg-red-600"}),(0,a.jsx)("span",{className:"text-sm",children:"Recording..."})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"audio-transcription-upload",children:"Or Upload Audio File"}),(0,a.jsx)(g.p,{type:"file",accept:"audio/*",onChange:sa,ref:eF,className:"file:mr-4 file:rounded-full file:border-0 file:bg-blue-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-blue-700 hover:file:bg-blue-100"}),ex&&(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,a.jsx)(e$.A,{className:"h-5 w-5 text-blue-500"}),(0,a.jsxs)("span",{className:"text-muted-foreground text-sm",children:["Selected audio: ",ex.name]}),(0,a.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>{eg(null),ev(null)},className:"ml-auto",children:"Remove"})]}),ej&&(0,a.jsx)("div",{className:"bg-muted mt-2 rounded-md p-4",children:(0,a.jsx)("audio",{controls:!0,src:ej,className:"w-full",children:"Your browser does not support the audio element."})})]})]})]});case"models":return(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(eK.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"This endpoint lists all available models from the provider. No additional parameters are required."})]})});default:return null}})(),(0,a.jsx)(x.$,{onClick:sd,disabled:!A||so.isPending,className:"w-full",children:so.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Testing ",eW[F].name,"..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eY.A,{className:"mr-2 h-4 w-4"}),"Test ",eW[F].name]})}),I&&(0,a.jsxs)($.Fc,{variant:"destructive",children:[(0,a.jsx)(eO.A,{className:"h-4 w-4"}),(0,a.jsxs)($.TN,{children:[(0,a.jsx)("strong",{children:"Test Failed:"})," ",I]})]}),R&&(0,a.jsxs)($.Fc,{children:[(0,a.jsx)(Z.A,{className:"h-4 w-4"}),(0,a.jsxs)($.TN,{children:[(0,a.jsx)("strong",{children:"Test Successful!"})," ",eW[F].name," endpoint responded correctly."]})]}),R&&(R?"type"in(y=R)&&"audio"===y.type?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Generated Audio"}),(0,a.jsxs)("div",{className:"bg-muted rounded-md p-4",children:[(0,a.jsx)("audio",{controls:!0,src:R.url,className:"w-full",children:"Your browser does not support the audio element."}),(0,a.jsxs)("p",{className:"text-muted-foreground mt-2 text-sm",children:["Audio file size: ",(R.size/1024).toFixed(2)," KB"]})]})]})}):"text"in R?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Transcription Result"}),(0,a.jsx)("div",{className:"bg-muted rounded-md p-4",children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:R.text||"No transcription result available"})})]})}):"choices"in R?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Model Response"}),(0,a.jsx)("div",{className:"bg-muted rounded-md p-4",children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:(null==(l=R.choices)||null==(t=l[0])||null==(s=t.message)?void 0:s.content)||"No content in response"})})]}),R.usage&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Usage Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"font-semibold",children:R.usage.prompt_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Prompt Tokens"})]}),(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"font-semibold",children:R.usage.completion_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Completion Tokens"})]}),(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center",children:[(0,a.jsx)("div",{className:"font-semibold",children:R.usage.total_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Total Tokens"})]})]})]})]}):"data"in(b=R)&&Array.isArray(b.data)&&b.data.length>0&&"embedding"in b.data[0]?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Embedding Vector"}),(0,a.jsxs)("div",{className:"bg-muted rounded-md p-4",children:[(0,a.jsxs)("p",{className:"text-muted-foreground mb-2 text-sm",children:["Generated ",(null==(c=R.data)||null==(d=c[0])||null==(o=d.embedding)?void 0:o.length)||0," ","dimensional embedding vector"]}),(0,a.jsxs)("details",{className:"group",children:[(0,a.jsx)("summary",{className:"hover:text-foreground cursor-pointer text-sm",children:"Show first 10 values"}),(0,a.jsxs)("pre",{className:"mt-2 text-xs",children:[JSON.stringify(null==(p=R.data)||null==(m=p[0])||null==(u=m.embedding)?void 0:u.slice(0,10),null,2),"..."]})]})]})]}),R.usage&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Usage Statistics"}),(0,a.jsxs)("div",{className:"bg-muted rounded p-2 text-center text-sm",children:[(0,a.jsx)("div",{className:"font-semibold",children:R.usage.total_tokens}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Total Tokens"})]})]})]}):"data"in(w=R)&&Array.isArray(w.data)&&w.data.length>0&&"url"in w.data[0]?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Generated Images"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:null==(h=R.data)?void 0:h.map((e,s)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"relative aspect-square w-full",children:(0,a.jsx)(eB.default,{src:e.url,alt:"Generated image ".concat(s+1),fill:!0,className:"rounded-md border object-cover",unoptimized:!0})}),e.revised_prompt&&(0,a.jsxs)("p",{className:"text-muted-foreground text-xs",children:["Revised prompt: ",e.revised_prompt]})]},s))})]})}):"data"in(_=R)&&Array.isArray(_.data)&&_.data.length>0&&"id"in _.data[0]?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Available Models"}),(0,a.jsx)("div",{className:"max-h-60 overflow-auto",children:(0,a.jsx)("div",{className:"grid gap-2",children:null==(v=R.data)?void 0:v.map(e=>(0,a.jsxs)("div",{className:"bg-muted rounded-md p-3",children:[(0,a.jsx)("div",{className:"font-medium",children:e.id}),e.object&&(0,a.jsxs)("div",{className:"text-muted-foreground text-sm",children:["Type: ",e.object]}),e.created&&(0,a.jsxs)("div",{className:"text-muted-foreground text-sm",children:["Created:"," ",new Date(1e3*e.created).toLocaleDateString()]})]},e.id))})})]})}):null:null),R&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{children:"Raw Response"}),(0,a.jsxs)("details",{className:"group",children:[(0,a.jsxs)("summary",{className:"text-muted-foreground hover:text-foreground cursor-pointer text-sm",children:[(0,a.jsx)(G.A,{className:"mr-1 inline h-4 w-4"}),"Show detailed response data"]}),(0,a.jsx)("pre",{className:"bg-muted mt-2 max-h-60 overflow-auto rounded-md p-4 text-xs",children:JSON.stringify(R,null,2)})]})]})]})]})}var eX=t(953),e0=t(7569),e2=t(4756),e4=t(6839);function e1(){let{data:e,isLoading:s,error:t}=(0,i.I)({queryKey:["admin-models-with-providers"],queryFn:()=>o.zQ.getModelsWithProviders(),refetchOnWindowFocus:!1}),{models:l=[],groups:n=[]}=e||{},d=(0,r.useMemo)(()=>l?l.reduce((e,s)=>{let t=s.provider;return e[t]||(e[t]=[]),e[t].push(s),e},{}):{},[l]),c=(0,r.useMemo)(()=>new Map(n.map(e=>[e.provider,e])),[n]),u=(0,r.useMemo)(()=>Object.entries(d).map(e=>{let[s,t]=e,a=c.get(s);return{provider:s,activeModels:t.filter(e=>!e.soft_deleted).length,totalModels:t.length,groupData:a,hasGroupUrl:!!(null==a?void 0:a.group_url),hasGroupApiKey:!!(null==a?void 0:a.group_api_key)}}),[d,c]);return(0,a.jsxs)(eX.SidebarProvider,{children:[(0,a.jsx)(e0.AppSidebar,{variant:"inset"}),(0,a.jsxs)(eX.SidebarInset,{children:[(0,a.jsx)(e2.SiteHeader,{}),(0,a.jsx)("div",{className:"flex flex-1 flex-col",children:(0,a.jsxs)("div",{className:"@container/main flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,a.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Model Management & API Testing"})}),(0,a.jsxs)(e4.tU,{defaultValue:"manage",className:"w-full",children:[(0,a.jsx)(e4.j7,{className:"grid w-full grid-cols-3",children:(0,a.jsx)(e4.Xi,{value:"manage",children:"Manage Models"})}),(0,a.jsxs)(e4.av,{value:"manage",className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Manage your AI models organized by provider groups. Configure API keys, and organize models by provider groups."}),s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(eo.E,{className:"h-[60px] w-full"}),(0,a.jsx)(eo.E,{className:"h-[400px] w-full"})]}):t?(0,a.jsxs)($.Fc,{variant:"destructive",children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"Failed to load models. Please try refreshing the page."})]}):(0,a.jsx)(e4.tU,{defaultValue:"all",className:"w-full",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"rounded-lg border p-1",children:(0,a.jsxs)(e4.j7,{className:"grid w-full max-w-full auto-cols-fr grid-flow-col overflow-x-auto",children:[(0,a.jsxs)(e4.Xi,{value:"all",className:"flex items-center gap-2",children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),"All Models",(0,a.jsx)(er.E,{variant:"secondary",className:"ml-1",children:l.length})]}),u.map(e=>{let{provider:s,activeModels:t,totalModels:r}=e;return(0,a.jsxs)(e4.Xi,{value:s,className:"flex min-w-fit items-center gap-2",children:[(0,a.jsx)(J.A,{className:"h-4 w-4"}),s,(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsxs)(er.E,{variant:"secondary",className:"ml-1",children:[t,"/",r]})})]},s)})]})}),(0,a.jsx)(e4.av,{value:"all",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Overview of all models across all provider groups."}),(0,a.jsx)(ez,{})]})}),Object.entries(d).map(e=>{let[s,t]=e,r=c.get(s);return(0,a.jsx)(e4.av,{value:s,children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2 text-lg font-semibold",children:[(0,a.jsx)(J.A,{className:"h-5 w-5"}),s]}),(0,a.jsxs)("div",{className:"text-muted-foreground flex items-center gap-4 text-sm",children:[t.filter(e=>e.soft_deleted).length>0&&(0,a.jsxs)("span",{className:"text-orange-600",children:[t.filter(e=>e.soft_deleted).length," ","soft deleted"]}),(null==r?void 0:r.group_url)&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(K.A,{className:"h-3 w-3"}),r.group_url]})]})]})}),(0,a.jsx)(ez,{filterProvider:s,groupData:r,showProviderActions:!0})]})},s)})]})})]}),(0,a.jsxs)(e4.av,{value:"test-basic",className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Test model credentials and connectivity with basic chat completion requests through the secure proxy (resolves CORS and Docker network issues). Models can be tested even without API keys configured (useful for free models or when authentication is handled elsewhere)."}),s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(eo.E,{className:"h-[200px] w-full"}),(0,a.jsx)(eo.E,{className:"h-[100px] w-full"})]}):t?(0,a.jsxs)($.Fc,{variant:"destructive",children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"Failed to load models for testing. Please try refreshing the page."})]}):(0,a.jsx)(eU,{models:l})]}),(0,a.jsxs)(e4.av,{value:"test-api",className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Comprehensive testing of all OpenAI API endpoints including chat completions, embeddings, image generation, audio synthesis, and model listing through the secure proxy (resolves CORS and Docker network issues). Models can be tested with or without API keys configured."}),s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(eo.E,{className:"h-[300px] w-full"}),(0,a.jsx)(eo.E,{className:"h-[200px] w-full"})]}):t?(0,a.jsxs)($.Fc,{variant:"destructive",children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),(0,a.jsx)($.TN,{children:"Failed to load models for API testing. Please try refreshing the page."})]}):(0,a.jsx)(eH,{models:l})]})]})]})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[363,222,808,29,730,978,481,982,938,236,255,945,497,358],()=>s(6715)),_N_E=e.O()}]);